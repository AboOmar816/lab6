<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Like/Dislike</title>
<style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    .buttons { margin-bottom: 20px; }
    button { padding: 10px 15px; margin-right: 10px; }
    #comments { margin-top: 20px; }
    .comment-box { margin-bottom: 10px; padding: 8px; background: #f1f1f1; border-radius: 5px; }
</style>
</head>

<body>

<h1>Like / Dislike </h1>

<div class="buttons">
    <button id="likeBtn">ğŸ‘ Like</button>
    <span id="likeCount">0</span>

    <button id="dislikeBtn">ğŸ‘ Dislike</button>
    <span id="dislikeCount">0</span>
</div>

<h3>Leave a Comment</h3>
<input type="text" id="commentInput" placeholder="Write a comment..." size="40">
<button id="submitComment">Submit Comment</button>

<div id="comments">
    <h3>Comments</h3>
    <div id="commentList"></div>
</div>

<button id="resetBtn" style="margin-top:20px; background:red; color:white;">
    Reset Vote & Comments
</button>

<script>
// ---------------------- COOKIE HELPERS ----------------------
function setCookie(name, value, days = 365) {
    const d = new Date();
    d.setTime(d.getTime() + (days*24*60*60*1000));
    document.cookie = `${name}=${value};expires=${d.toUTCString()};path=/`;
}
function getCookie(name) {
    const cookieArr = document.cookie.split(";");
    for (let c of cookieArr) {
        c = c.trim();
        if (c.startsWith(name + "=")) {
            return c.split("=")[1];
        }
    }
    return null;
}
function deleteCookie(name) {
    document.cookie = name + "=; expires=Thu, 01 Jan 1970; path=/";
}

// ---------------------- STATE VARIABLES ----------------------
let likes = 0;
let dislikes = 0;
let comments = [];

// ---------------------- DOM ELEMENTS ----------------------
const likeBtn = document.getElementById("likeBtn");
const dislikeBtn = document.getElementById("dislikeBtn");
const likeCount = document.getElementById("likeCount");
const dislikeCount = document.getElementById("dislikeCount");
const commentInput = document.getElementById("commentInput");
const submitComment = document.getElementById("submitComment");
const commentList = document.getElementById("commentList");
const resetBtn = document.getElementById("resetBtn");

// ---------------------- LOAD STATE FROM COOKIES ----------------------
function loadState() {
    const storedLikes = getCookie("likes");
    const storedDislikes = getCookie("dislikes");
    const userChoice = getCookie("userChoice");
    const storedComments = getCookie("comments");

    if (storedLikes) likes = parseInt(storedLikes);
    if (storedDislikes) dislikes = parseInt(storedDislikes);
    if (storedComments) comments = JSON.parse(storedComments);

    updateUI();

    if (userChoice) {
        // Disable buttons if user already voted
        likeBtn.disabled = true;
        dislikeBtn.disabled = true;
    }

    if (getCookie("userCommented")) {
        submitComment.disabled = true;
        commentInput.disabled = true;
    }
}

// ---------------------- UPDATE UI ----------------------
function updateUI() {
    likeCount.textContent = likes;
    dislikeCount.textContent = dislikes;

    commentList.innerHTML = "";
    comments.forEach(c => {
        const div = document.createElement("div");
        div.className = "comment-box";
        div.textContent = c;
        commentList.appendChild(div);
    });
}

// ---------------------- LIKE BUTTON ----------------------
likeBtn.onclick = () => {
    if (!getCookie("userChoice")) {
        likes++;
        setCookie("likes", likes);
        setCookie("userChoice", "like");
        likeBtn.disabled = true;
        dislikeBtn.disabled = true;
        updateUI();
    }
};

// ---------------------- DISLIKE BUTTON ----------------------
dislikeBtn.onclick = () => {
    if (!getCookie("userChoice")) {
        dislikes++;
        setCookie("dislikes", dislikes);
        setCookie("userChoice", "dislike");
        likeBtn.disabled = true;
        dislikeBtn.disabled = true;
        updateUI();
    }
};

// ---------------------- COMMENTS ----------------------
submitComment.onclick = () => {
    if (!getCookie("userCommented")) {
        const text = commentInput.value.trim();
        if (text !== "") {
            comments.push(text);
            setCookie("comments", JSON.stringify(comments));
            setCookie("userCommented", "true");

            commentInput.value = "";
            submitComment.disabled = true;
            commentInput.disabled = true;

            updateUI();
        }
    }
};

// ---------------------- RESET ----------------------
resetBtn.onclick = () => {
    // Reset counters
    likes = 0;
    dislikes = 0;
    comments = [];

    // Delete cookies
    ["likes","dislikes","comments","userChoice","userCommented"].forEach(deleteCookie);

    // Re-enable UI
    likeBtn.disabled = false;
    dislikeBtn.disabled = false;
    submitComment.disabled = false;
    commentInput.disabled = false;

    updateUI();
};

// Initialize on load
loadState();

</script>

</body>
</html>
